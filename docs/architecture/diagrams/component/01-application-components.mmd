---
id: 7a0c7b7f-3f2b-4f8a-8f2c-6c3e0c4da2f2
---
flowchart TB

classDef componentPrimary   fill:#f5f5f5,stroke:#444,stroke-width:1.5px,color:#111,font-size:22px;
classDef componentSecondary fill:#e3e7ec,stroke:#555,stroke-width:1.2px,color:#111,font-size:18px;
classDef external           fill:#dde7f2,stroke:#44546a,stroke-width:1.5px,color:#111,font-size:22px;
classDef group              fill:#e6ecef,stroke:#333,stroke-width:1.5px,color:#111,font-size:22px;

subgraph Entry["Interfaces / Entry Points"]
    CLI["CLI (Typer) / REST / MQ\nbioetl.interfaces.*"]:::external
end
class Entry group;

subgraph Application["Application Layer"]
    Orchestrator["PipelineOrchestrator\nbioetl.application.orchestrator"]:::componentPrimary
    Container["PipelineContainer\nbioetl.application.container"]:::componentPrimary
    PipelineRegistry["Pipeline Registry\nbioetl.application.pipelines.registry"]:::componentSecondary
    ConfigLoader["Config Loader\napplication.config_loader"]:::componentSecondary
    PipelineConfig["PipelineConfig\nconfig.pipeline_config_schema"]:::componentSecondary
    StageRunner["StageRunner\napplication.pipelines.stage_runner"]:::componentSecondary
    Hooks["Hooks (Logging + Metrics)\nLoggingPipelineHookImpl\nMetricsPipelineHookImpl"]:::componentSecondary
    ErrorPolicy["ErrorPolicyManager\nFailFast/ContinueOnError"]:::componentSecondary
    Pipelines["PipelineBase / ChemblPipelineBase /\nChemblEntityPipeline\napplication.pipelines.*"]:::componentSecondary
end
class Application group;

subgraph Domain["Domain Dependencies"]
    Validation["ValidationService\nbioetl.domain.validation.service"]:::componentSecondary
    Normalization["NormalizationServiceImpl\nbioetl.infrastructure.transform.impl.normalize"]:::componentSecondary
    Hashing["HashServiceABC\nbioetl.domain.transform.contracts"]:::componentSecondary
    Transformers["TransformerChain\nHash/Index/Fulldate/DbVersion"]:::componentSecondary
    Contracts["PipelineSchemaContract\nbioetl.domain.schemas.pipeline_contracts"]:::componentSecondary
    Schemas["SchemaRegistry + PanderaValidator\nbioetl.domain.schemas.registry"]:::componentSecondary
end
class Domain group;

subgraph Infrastructure["Infrastructure Dependencies"]
    ProviderRegistry["ProviderRegistry + Loader\nconfigs/providers.yaml\ninfrastructure.clients.provider_registry_loader"]:::componentSecondary
    Clients["ChEMBL Client Stack\nUnifiedAPIClient + ChemblDataClientHTTPImpl"]:::componentSecondary
    RecordSources["Record Sources\nApiRecordSource / CsvRecordSourceImpl / IdListRecordSourceImpl"]:::componentSecondary
    Output["UnifiedOutputWriter\nCSV writer + MetadataWriter + QC"]:::componentSecondary
    Logging["Unified Logger\ninfrastructure.logging.*"]:::componentSecondary
    Observability["Prometheus Metrics\nstart_metrics_server_once"]:::componentSecondary
end
class Infrastructure group;

CLI --> Orchestrator
ConfigLoader --> PipelineConfig
Orchestrator --> PipelineRegistry
Orchestrator --> Container
Orchestrator --> StageRunner
Container --> Pipelines
Container --> Validation
Container --> Normalization
Container --> Hashing
Container --> Transformers
Container --> Contracts
Container --> Schemas
Container --> ProviderRegistry
Container --> Clients
Container --> RecordSources
Container --> Output
Container --> Logging
Container --> Observability
Pipelines --> StageRunner
Pipelines --> Validation
Pipelines --> Normalization
Pipelines --> Hashing
Pipelines --> Output
Pipelines --> Logging
Pipelines --> Hooks
StageRunner --> Hooks
StageRunner --> ErrorPolicy
Validation --> Schemas
Normalization --> Contracts
RecordSources --> Clients

