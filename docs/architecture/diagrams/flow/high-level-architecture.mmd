flowchart LR

subgraph Interfaces["Interfaces (Driving)"]
    CLI[CLI App]:::componentPrimary
    RestAPI[REST Server]:::componentSecondary
    MQ[MQ Listener]:::componentSecondary
end
class Interfaces group;

subgraph Application["Application Layer"]
    Pipeline[Pipeline Orchestrator]:::componentPrimary
    Hooks[Pipeline Hooks]:::componentSecondary
end
class Application group;

subgraph Domain["Domain Layer (Core)"]
    Validation[Validation Service]:::componentPrimary
    Normalization[Normalization Service]:::componentPrimary
    Hashing[Hash Service]:::componentSecondary
    Schemas[Pandera Schemas]:::componentSecondary
end
class Domain group;

subgraph Infrastructure["Infrastructure (Driven)"]
    subgraph Input
        ChEMBL[ChEMBL Client]:::componentPrimary
        PubChem[PubChem Client]:::componentSecondary
    end
    subgraph Output
        Writer[Unified Output Writer]:::componentPrimary
        Logger[Unified Logger]:::componentSecondary
    end
    subgraph Config
        CfgLoad[Config Loader]:::componentSecondary
        Pydantic[Pydantic Models]:::componentSecondary
    end
end
class Infrastructure group;

ExtChEMBL[(ChEMBL REST API)]:::external
ExtPubChem[(PubChem API)]:::external

CLI -->|Calls| Pipeline
RestAPI --> Pipeline
MQ --> Pipeline

Pipeline -->|Uses| Validation
Pipeline -->|Uses| Normalization
Pipeline -->|Uses| Hashing
Validation -->|Validates| Schemas
Normalization -.->|Uses| Schemas

Pipeline -->|Uses| ChEMBL
Pipeline -->|Uses| PubChem
Pipeline -->|Uses| Writer
Pipeline -->|Uses| Logger
Pipeline -->|Configures| CfgLoad
Pipeline -->|Reads| Pydantic

ChEMBL --> ExtChEMBL
PubChem --> ExtPubChem

classDef componentPrimary   fill:#f5f5f5,stroke:#444,stroke-width:1.5px,color:#111,font-size:22px;
classDef componentSecondary fill:#e3e7ec,stroke:#555,stroke-width:1.2px,color:#111,font-size:18px;
classDef external           fill:#dde7f2,stroke:#44546a,stroke-width:1.5px,color:#111,font-size:22px;
classDef group              fill:#e6ecef,stroke:#333,stroke-width:1.5px,color:#111,font-size:22px;

