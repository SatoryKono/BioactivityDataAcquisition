classDiagram

    %% Styling
    classDef domainPrimary   fill:#f5f5f5,stroke:#444,stroke-width:1.5px,color:#111,font-size:22px;
    classDef domainSecondary fill:#e3e7ec,stroke:#555,stroke-width:1.2px,color:#111,font-size:18px;
    classDef interface       fill:#dde7f2,stroke:#44546a,stroke-width:1.5px,color:#111,font-size:22px;

    %% Core Contracts
    class SourceClientABC {
        <<Interface>>
        +fetch_one(id)
        +fetch_many(ids)
        +iter_pages(request)
        +metadata()
    }

    class RequestBuilderABC {
        <<Interface>>
        +build(params)
        +with_pagination(offset, limit)
    }

    class ResponseParserABC {
        <<Interface>>
        +parse(response)
        +extract_metadata(response)
    }

    class ChemblClientHTTPImpl {
        -http_session: ClientSession
        -rate_limiter: RateLimiterABC
        -retry_policy: RetryPolicyABC
        +fetch_one(id)
        +fetch_many(ids)
        +iter_pages(request)
    }

    class ChemblClientFactory {
        +create_client(config) SourceClientABC
        +create_default() SourceClientABC
    }

    SourceClientABC <|-- ChemblClientHTTPImpl
    ChemblClientFactory ..> SourceClientABC : creates
    ChemblClientFactory ..> ChemblClientHTTPImpl : instantiates

    ChemblClientHTTPImpl *-- RequestBuilderABC : uses
    ChemblClientHTTPImpl *-- ResponseParserABC : uses
    ChemblClientHTTPImpl *-- RateLimiterABC : uses
    ChemblClientHTTPImpl *-- RetryPolicyABC : uses

    class ChemblClientHTTPImpl domainPrimary
    class ChemblClientFactory domainSecondary
    class SourceClientABC interface
    class RequestBuilderABC interface
    class ResponseParserABC interface
