# 01 Base External Data Client

> **Deprecated**: Этот класс используется только в старых пайплайнах. Для новых клиентов рекомендуется использовать архитектуру на основе `BaseClient` и `ConfiguredHttpClient` с YAML-конфигурациями. См. `docs/02-pipelines/clients/06-clients-overview.md` для миграции.

## Описание

BaseExternalDataClient — базовый класс для клиентов внешних API, реализующий SourceClientABC. Содержит общую логику пагинации и сбор данных из REST API (циклический запрос страниц, объединение параметров и т.п.). Конкретные клиенты (ChEMBL, PubChem и др.) наследуются от этого класса, переопределяя при необходимости специфичные части.

Базовый класс инкапсулирует общие паттерны работы с REST API:
- Автоматическая пагинация с обработкой различных форматов ответов
- Объединение параметров запроса
- Обработка ошибок и повторные попытки
- Управление сессиями HTTP

## Модуль

`src/bioetl/core/pipeline/source/client.py`

## Функциональность

### Пагинация

Базовый класс реализует общую логику пагинации для старых пайплайнов. Для новой архитектуры пагинация обрабатывается через `HttpBackend` и `PaginationParams` (см. `docs/02-pipelines/clients/06-clients-overview.md`).

**Реализованные возможности:**
- Циклический запрос страниц до получения всех данных
- Поддержка различных форматов пагинации (offset/limit, cursor-based, page-based)
- Автоматическое объединение результатов со всех страниц
- Обработка пустых страниц и граничных случаев

### Управление запросами

- Объединение базовых параметров запроса с параметрами конкретного запроса
- Поддержка различных форматов ответов (JSON, XML, CSV)
- Обработка заголовков и метаданных ответов

### Обработка ошибок

- Интеграция с RetryPolicyABC для повторных попыток
- Использование RateLimiterABC для контроля частоты запросов
- Логирование ошибок через LoggerAdapterABC

## Наследование

Конкретные клиенты наследуются от BaseExternalDataClient и переопределяют:
- Методы построения запросов для специфичных API
- Парсинг ответов в структуры данных домена
- Обработку специфичных форматов пагинации
- Аутентификацию и авторизацию

## Связь с другими абстракциями

BaseExternalDataClient реализует интерфейс SourceClientABC (`docs/reference/abc/23-source-client-abc.md`), но использует более специфичные методы для работы с REST API.

**Отличие от BaseClient/ConfiguredHttpClient:**

- **BaseExternalDataClient** (deprecated) — используется только в старых пайплайнах, реализует SourceClientABC напрямую
- **BaseClient/ConfiguredHttpClient** — целевая архитектура с YAML-конфигурациями, использует HttpBackend Protocol. Рекомендуется для новых клиентов.

## Related Components

- **SourceClientABC**: базовый интерфейс клиента источника данных (`docs/reference/abc/23-source-client-abc.md`)
- **BaseClient**: альтернативный ABC для YAML-driven клиентов (см. `docs/02-pipelines/clients/06-clients-overview.md`)
- **RequestBuilderABC**: построение запросов к API
- **ResponseParserABC**: разбор ответов API
- **PaginatorABC**: стратегия пагинации
- **RetryPolicyABC**: политика повторных попыток
- **RateLimiterABC**: ограничение частоты запросов
- **LoggerAdapterABC**: логирование операций

