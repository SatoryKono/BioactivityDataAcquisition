# 04 Testing

## Типы тестов
- Юнит-тесты клиентов: проверка HTTP-ретраев, кэша, пагинации, лимитов.
- Тесты стадий пайплайнов: отдельные проверки extract/transform/validate/write с фикстурами данных.
- Golden и интеграционные тесты: сравнение результатов пайплайна с эталонными артефактами.

## Покрытие
Цель — ≥85% для критичных модулей. Особое внимание на детерминизм (фиксированные сортировки, хеши, column_order).

## Подходы
- Мокаем внешние API, проверяем retry/backoff и rate limiting.
- Для transform/validate используем тестовые Pandera-схемы и фиктивные таблицы.
- В интеграционных тестах проверяем наличие meta.yaml, QC-отчётов и корректность checksums.

## Детализированные сценарии
- Тестирование ErrorPolicy (fail-fast vs. tolerant).
- Проверка dry-run: стадии записи пропускаются, валидация выполняется.
- Регенерация golden-артефактов только при осознанных изменениях схем/логики.
