# Molecule Pipeline Configuration
# Наследует общие параметры из chembl_default profile

extends: chembl_default

entity_name: molecule
endpoint: /molecule
primary_key: molecule_chembl_id

pipeline:
  name: testitem_chembl
  version: "0.1.0"
  owner: bioetl-team
  description: "ChEMBL Molecules (/molecule) → normalized test items"

sources:
  chembl:
    provider: chembl
    batch_size: 25
    base_url: "https://www.ebi.ac.uk/chembl/api/data"
    max_url_length: 2000

input_mode: id_only
input_path: data/input/testitem.csv
csv_options:
  delimiter: ","
  header: true
  
fields:
  - name: atc_classifications
    data_type: array
    is_nullable: true
    is_filterable: false
    description: ATC-коды и описания

  - name: availability_type
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Тип доступности (0 - снят, 1 - Rx, 2 - OTC)

  - name: black_box_warning
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг наличия black box warning

  - name: chemical_probe
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг chemical probe

  - name: chirality
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Код хиральности

  - name: cross_references
    data_type: array
    is_nullable: true
    is_filterable: false
    description: Внешние кросс-референсы

  - name: dosed_ingredient
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Используется как дозируемый ингредиент

  - name: first_approval
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Год первого одобрения

  - name: first_in_class
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг «первый в классе»

  - name: helm_notation
    data_type: string
    is_nullable: true
    is_filterable: false
    description: HELM-нотация

  - name: inorganic_flag
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг неорганического соединения

  - name: max_phase
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Максимальная фаза клинических исследований (0-4)

  - name: molecule_chembl_id
    data_type: string
    is_nullable: false
    is_filterable: true
    description: ChEMBL ID молекулы

  - name: molecule_hierarchy
    data_type: object
    is_nullable: true
    is_filterable: false
    description: Иерархия молекулы

  - name: molecule_properties
    data_type: object
    is_nullable: true
    is_filterable: false
    description: Физико-химические свойства молекулы

  - name: molecule_structures
    data_type: object
    is_nullable: true
    is_filterable: false
    description: Структурные представления молекулы (SMILES, InChI и т.п.)

  - name: molecule_synonyms
    data_type: array
    is_nullable: true
    is_filterable: false
    description: Синонимы молекулы

  - name: molecule_type
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Тип молекулы (Small molecule, Protein, Antibody и т.п.)

  - name: natural_product
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг природного происхождения

  - name: oral
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Оральное применение

  - name: orphan
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Orphan-drug статус

  - name: parenteral
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Парентеральное применение

  - name: polymer_flag
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг полимерной природы

  - name: pref_name
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Предпочтительное название молекулы

  - name: prodrug
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг «пролекарство»

  - name: structure_type
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Тип структурного представления (MOL, SEQUENCE и др.)

  - name: therapeutic_flag
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Является терапевтическим агентом

  - name: topical
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Наружное применение

  - name: usan_stem
    data_type: string
    is_nullable: true
    is_filterable: true
    description: USAN stem

  - name: usan_stem_definition
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Определение USAN stem

  - name: usan_substem
    data_type: string
    is_nullable: true
    is_filterable: true
    description: USAN substem

  - name: usan_year
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Год присвоения USAN

  - name: veterinary
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Флаг ветеринарного применения

  - name: withdrawn_flag
    data_type: boolean
    is_nullable: true
    is_filterable: true
    description: Снят ли с рынка

hashing:
  business_key_fields:
    - molecule_chembl_id

# pagination наследуется из chembl_default profile
