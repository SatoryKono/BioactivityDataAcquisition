# Activity Pipeline Configuration
# Наследует общие параметры из chembl_default profile

extends: chembl_default

entity_name: activity
endpoint: /activity
primary_key: activity_id

sources:
  chembl:
    provider: chembl
    batch_size: 100
    base_url: "https://www.ebi.ac.uk/chembl/api/data"
    max_url_length: 2000
    data_validity:
      enabled: false
      page_limit: 100

cli:
  input_file: data/input/activity.csv
  input_full_dataset: false

fields:
  - name: action_type
    data_type: object
    is_nullable: true
    is_filterable: false
    description: Тип действия (agonist, antagonist и т.п.)

  - name: activity_comment
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Комментарий к активности

  - name: activity_id
    data_type: integer
    is_nullable: false
    is_filterable: false
    description: Внутренний ID активности

  - name: activity_properties
    data_type: array
    is_nullable: true
    is_filterable: false
    description: Список дополнительных свойств активности

  - name: assay_chembl_id
    data_type: string
    is_nullable: false
    is_filterable: true
    description: ChEMBL ID ассая

  - name: assay_description
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Текстовое описание ассая

  - name: assay_type
    data_type: string
    is_nullable: false
    is_filterable: true
    description: Тип ассая (B, F, A, P и т.п.)

  - name: assay_variant_accession
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Accession варианта белка

  - name: assay_variant_mutation
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Описание мутаций варианта белка

  - name: bao_endpoint
    data_type: string
    is_nullable: true
    is_filterable: false
    description: BAO endpoint term

  - name: bao_format
    data_type: string
    is_nullable: true
    is_filterable: false
    description: BAO format term

  - name: bao_label
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Человекочитаемый label для BAO endpoint/format

  - name: canonical_smiles
    data_type: string
    is_nullable: false
    is_filterable: false
    description: Канонический SMILES молекулы

  - name: data_validity_comment
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Комментарий о качестве/валидности

  - name: data_validity_description
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Нормализованное описание проблем с данными

  - name: document_chembl_id
    data_type: string
    is_nullable: false
    is_filterable: true
    description: Документ ChEMBL, откуда пришла активность

  - name: document_journal
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Название журнала

  - name: document_year
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Год публикации

  - name: ligand_efficiency
    data_type: object
    is_nullable: true
    is_filterable: false
    description: Объект с метриками LE/BEI/LLE/SEI

  - name: molecule_chembl_id
    data_type: string
    is_nullable: false
    is_filterable: true
    description: ChEMBL ID молекулы

  - name: molecule_pref_name
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Название молекулы

  - name: parent_molecule_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: ChEMBL ID родительской молекулы (без соли/формы)

  - name: pchembl_value
    data_type: number
    is_nullable: true
    is_filterable: true
    description: Нормализованная активность (−log10(M) для стандартных типов)

  - name: potential_duplicate
    data_type: boolean
    is_nullable: true
    is_filterable: false
    description: Флаг потенциального дубликата записи

  - name: qudt_units
    data_type: string
    is_nullable: true
    is_filterable: false
    description: URI единиц в QUDT

  - name: record_id
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: FK на запись compound_record (соединение × документ)

  - name: relation
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Исходное отношение (=, >, <, >=, <=, ~)

  - name: src_id
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Источник данных (PubChem, журнал, депозиты и т.п.)

  - name: standard_flag
    data_type: boolean
    is_nullable: false
    is_filterable: false
    description: Признак, что тип/значение/единицы нормализованы

  - name: standard_relation
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Нормализованное отношение

  - name: standard_text_value
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Нормализованный текст для качественных readout'ов

  - name: standard_type
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Нормализованный тип активности

  - name: standard_units
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Нормализованные единицы

  - name: standard_upper_value
    data_type: number
    is_nullable: true
    is_filterable: false
    description: Верхняя граница интервала в нормализованных единицах

  - name: standard_value
    data_type: number
    is_nullable: true
    is_filterable: true
    description: Числовое нормализованное значение

  - name: target_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: ChEMBL ID таргета

  - name: target_organism
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Организм таргета

  - name: target_pref_name
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Название таргета

  - name: target_tax_id
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: NCBI TaxID таргета

  - name: text_value
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Исходное текстовое значение

  - name: toid
    data_type: string
    is_nullable: true
    is_filterable: false
    description: ID из Target Ontology

  - name: type
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Исходный тип активности (как в источнике)

  - name: units
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Исходные единицы измерения

  - name: uo_units
    data_type: string
    is_nullable: true
    is_filterable: false
    description: ID из Unit Ontology (UO)

  - name: upper_value
    data_type: number
    is_nullable: true
    is_filterable: false
    description: Верхняя граница исходного интервала

  - name: value
    data_type: number
    is_nullable: true
    is_filterable: true
    description: Исходное числовое значение

hashing:
  business_key_fields:
   - activity_id
   - molecule_chembl_id
   - target_chembl_id

# Специфичные параметры пайплайна (общие параметры наследуются из профиля)
pipeline:
  enable_denormalization: false
  
# pagination наследуется из chembl_default profile
