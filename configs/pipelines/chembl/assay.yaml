# Assay Pipeline Configuration
# Наследует общие параметры из chembl_default profile

extends: chembl_default

entity_name: assay
endpoint: /assay
primary_key: assay_chembl_id

pipeline:
  name: assay_chembl
  version: "1.0.0"
  owner: "Data Acquisition Team"
  description: "Extract assay records from ChEMBL API"

sources:
  chembl:
    provider: chembl
    batch_size: 25
    base_url: "https://www.ebi.ac.uk/chembl/api/data"
    max_url_length: 2000

cli:
  input_file: data/input/assay.csv
  input_full_dataset: false

fields:
  - name: aidx
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Внутренний индекс ассая/ID депозитора

  - name: assay_chembl_id
    data_type: string
    is_nullable: false
    is_filterable: true
    description: ChEMBL ID ассая

  - name: assay_category
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Категория ассая (primary, confirmatory, screening и т.п.)

  - name: assay_cell_type
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Тип клетки, если ассай клеточный

  - name: assay_classifications
    data_type: array
    is_nullable: true
    is_filterable: false
    description: Классификации ассая

  - name: assay_group
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Группа/серия ассая

  - name: assay_organism
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Организм системы тестирования

  - name: assay_parameters
    data_type: array
    is_nullable: true
    is_filterable: false
    description: Параметры теста

  - name: assay_strain
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Штамм организма

  - name: assay_subcellular_fraction
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Субклеточная фракция

  - name: assay_tax_id
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: NCBI Taxonomy ID организма

  - name: assay_test_type
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Тип теста (in vitro / in vivo / ex vivo и т.п.)

  - name: assay_tissue
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Описание ткани

  - name: assay_type
    data_type: string
    is_nullable: false
    is_filterable: true
    description: Тип ассая (B – binding, F – functional и т.д.)

  - name: assay_type_description
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Текстовое описание assay_type

  - name: bao_format
    data_type: string
    is_nullable: true
    is_filterable: false
    description: BAO формат ассая

  - name: bao_label
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Читабельная метка BAO-формата

  - name: cell_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Ссылка на клеточную линию

  - name: confidence_description
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Текстовое описание уровня уверенности

  - name: confidence_score
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: Уверенность маппинга ассая к таргету (0–9)

  - name: description
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Описание теста

  - name: document_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Документ, описывающий ассай

  - name: relationship_description
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Расшифровка relationship_type

  - name: relationship_type
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Тип связи ассая с таргетом

  - name: score
    data_type: number
    is_nullable: true
    is_filterable: false
    description: Score для ранжирования ассая при поиске

  - name: src_assay_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: Идентификатор ассая в исходной БД

  - name: src_id
    data_type: integer
    is_nullable: true
    is_filterable: true
    description: ID источника данных

  - name: target_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: ChEMBL ID таргета

  - name: tissue_chembl_id
    data_type: string
    is_nullable: true
    is_filterable: true
    description: ChEMBL ID ткани

  - name: variant_sequence
    data_type: string
    is_nullable: true
    is_filterable: false
    description: Последовательность варианта белка

hashing:
    business_key_fields:
      - assay_chembl_id
      - document_chembl_id
      - target_chembl_id

normalization:
  id_fields:
    - assay_type

# pagination наследуется из chembl_default profile
